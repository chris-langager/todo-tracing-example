(()=>{"use strict";var t={607:function(t,e,n){var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};e.__esModule=!0;var c,s,l=n(544),d=n(593),f=document.getElementById("todos"),h=document.getElementById("user-form"),p=document.getElementById("user-input");function v(t){return o(this,void 0,void 0,(function(){var e,n,o,a,d,h;return i(this,(function(i){switch(i.label){case 0:return t.preventDefault(),e=u(t.target,1),n=e[0],o=n.value,[4,l.createTodo({boardId:c,text:o})];case 1:return a=i.sent(),d=b(r(r({},a),{createdBy:s})),f.appendChild(d),(h=document.getElementById("new-todo-input")).value="",h.focus(),[2]}}))}))}function y(t){return o(this,void 0,void 0,(function(){var e,n,r,o,u,s,d,h,p,v,y,m,w;return i(this,(function(i){switch(i.label){case 0:if(e=t.id,n=t.name,c===e)return[2];c=e,r=document.getElementsByClassName("board");try{for(o=a(Array.from(r)),u=o.next();!u.done;u=o.next())u.value.classList.remove("selected")}catch(t){v={error:t}}finally{try{u&&!u.done&&(y=o.return)&&y.call(o)}finally{if(v)throw v.error}}return document.getElementById("board-"+e).classList.add("selected"),f.innerHTML="loading "+n+" board...",[4,l.listTodos(e)];case 1:s=i.sent(),f.innerHTML="";try{for(d=a(s.map(b)),h=d.next();!h.done;h=d.next())p=h.value,f.appendChild(p)}catch(t){m={error:t}}finally{try{h&&!h.done&&(w=d.return)&&w.call(d)}finally{if(m)throw m.error}}return[2]}}))}))}function m(t){var e=t.id,n=t.name,r=(0,d.htmlToElement)('\n  <div id="board-'+e+'" class="board">\n     '+n+"\n  </div>\n  ");return r.onclick=function(){return y(t)},r}function b(t){var e=this,n=(0,d.htmlToElement)('\n      <div id="todo-'+t.id+'" class="todo '+(t.completed?"completed":"")+'">\n        <div class="top">   \n          <div class="todo-text">\n            '+t.text+'\n          </div>\n      \n          <div class="delete" onclick="deleteButtonClicked(event, \''+t.id+'\')">x</div>\n        </div>\n\n        <div class="bottom">  \n          <div class="todo-created-by todo-created-by-'+t.createdBy.id+'">\n          '+t.createdBy.name+'\n          </div>\n\n          <div class="todo-date-created">\n          '+new Date(t.dateCreated).toLocaleString()+"\n          </div>\n        </div>\n      </div>\n      ");return n.onclick=function(){return o(e,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:t.completed=!t.completed,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l.updateTodo(t)];case 2:return r.sent(),n.classList.toggle("completed"),[3,4];case 3:return e=r.sent(),console.log(e),t.completed=!t.completed,[3,4];case 4:return[2]}}))}))},n}!function(){o(this,void 0,void 0,(function(){var t,e,n,u,c,d,f,b;return i(this,(function(w){switch(w.label){case 0:return[4,l.getSelf()];case 1:return s=w.sent(),p.value=s.name,h.onsubmit=function(t){t.preventDefault(),function(t){o(this,void 0,void 0,(function(){var e,n,o,u,c;return i(this,(function(i){switch(i.label){case 0:return[4,l.updateUser(r(r({},s),{name:t}))];case 1:s=i.sent(),p.value=s.name,p.blur(),e=document.getElementsByClassName("todo-created-by-"+s.id);try{for(n=a(Array.from(e)),o=n.next();!o.done;o=n.next())o.value.innerHTML=s.name}catch(t){u={error:t}}finally{try{o&&!o.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}}return[2]}}))}))}(t.target[0].value)},[4,l.listBoards()];case 2:t=w.sent(),e=document.getElementById("boards"),w.label=3;case 3:w.trys.push([3,8,9,10]),n=a(t.map(m)),u=n.next(),w.label=4;case 4:return u.done?[3,7]:(c=u.value,[4,e.appendChild(c)]);case 5:w.sent(),w.label=6;case 6:return u=n.next(),[3,4];case 7:return[3,10];case 8:return d=w.sent(),f={error:d},[3,10];case 9:try{u&&!u.done&&(b=n.return)&&b.call(n)}finally{if(f)throw f.error}return[7];case 10:return y(t[0]),document.getElementById("new-todo-form").onsubmit=v,[2]}}))}))}(),window.deleteButtonClicked=function(t,e){return o(void 0,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t.stopPropagation(),[4,l.deleteTodo(e)];case 1:return n.sent(),document.getElementById("todo-"+e).remove(),[2]}}))}))}},544:function(t,e){var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)},r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};e.__esModule=!0,e.deleteTodo=e.updateTodo=e.createTodo=e.listTodos=e.listBoards=e.updateUser=e.getSelf=void 0,e.getSelf=function(){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,fetch("/api/self").then((function(t){return t.json()}))];case 1:return[2,t.sent()]}}))}))},e.updateUser=function(t){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("/api/users/"+t.id,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(t)}).then((function(t){if(200!==t.status)throw new Error("error updating user");return t.json()}))];case 1:return[2,e.sent()]}}))}))},e.listBoards=function(){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,fetch("/api/boards").then((function(t){return t.json()}))];case 1:return[2,t.sent().data]}}))}))},e.listTodos=function(t){return r(this,void 0,void 0,(function(){var e,r,u,c;return o(this,(function(o){switch(o.label){case 0:return[4,fetch("/api/todos?boardId="+t).then((function(t){return t.json()}))];case 1:return e=o.sent().data,r=a([],i(new Set(e.map((function(t){return t.createdBy})))),!1),[4,fetch("/api/users?ids="+r.join(",")).then((function(t){return t.json()}))];case 2:return u=o.sent().data,c=u.reduce((function(t,e){return t[e.id]=e,t}),{}),[2,e.map((function(t){return n(n({},t),{createdBy:c[t.createdBy]||null})}))]}}))}))},e.createTodo=function(t){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(n){return[2,fetch("/api/todos",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(t)}).then((function(t){return r(e,void 0,void 0,(function(){return o(this,(function(e){if(200!==t.status)throw new Error("error creating todo");return[2,t.json()]}))}))}))]}))}))},e.updateTodo=function(t){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("/api/todos/"+t.id,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(t)}).then((function(t){if(200!==t.status)throw new Error("error updating todo")}))];case 1:return e.sent(),[2]}}))}))},e.deleteTodo=function(t){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("/api/todos/"+t,{method:"DELETE"}).then((function(t){if(200!==t.status)throw new Error("error deleting todo")}))];case 1:return e.sent(),[2]}}))}))}},593:(t,e)=>{e.__esModule=!0,e.htmlToElement=void 0,e.htmlToElement=function(t){var e=document.createElement("template");return t=t.trim(),e.innerHTML=t,e.content.firstChild}}},e={};!function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(607)})();